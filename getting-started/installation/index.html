<!DOCTYPE html>
<html lang="zh">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>本地安装 - ELK Workshop</title>
<meta name="description" content="为Elastic技术社区精心打造">
<meta name="generator" content="Hugo 0.54.0" />
<link href="https://elk-workshop.github.io/index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://elk-workshop.github.io/getting-started/installation/">
<link rel="stylesheet" href="https://elk-workshop.github.io/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://elk-workshop.github.io/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://elk-workshop.github.io/js/functions.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://elk-workshop.github.io/js/jquery.backtothetop/jquery.backtothetop.min.js"></script></head>
<body>
<div class="container"><header>
<h1>ELK Workshop</h1>

 <span class="version">Version 0.1.0</span>
<a href="https://github.com/martinliu/elasticstack-workshop" class="github"><i class="fab fa-github"></i></a>
<p class="description">为Elastic技术社区精心打造</p>

</header>

<div class="content-container">
<main><h1>本地安装</h1>

<h2 id="环境需求">环境需求</h2>

<p>笔记本电脑的软硬件需求如下。</p>

<p>硬件配置：</p>

<ul>
<li>8GB内存</li>
<li>2核以上CPU</li>
<li>SSD硬盘</li>
<li>Wifi/有线网络，可以上Internet</li>
</ul>

<p>软件配置：</p>

<ul>
<li>MacOS、Windows 或者 Linux 操作系统都可以</li>
<li>SSH终端登录软件，例如 iTerm2、Terminal、 <a href="https://cmder.net/">cmder for Windows 10</a></li>
<li>VirtualBox 6.0 用于运行实验环境的虚拟机</li>
<li>Centos 7.6 用于安装和运行Elastic产品</li>
<li>最小虚拟机资源配置

<ul>
<li>CPU - 1 Core</li>
<li>RAM - 4 GB</li>
<li>硬盘 - 80 GB</li>
<li>网络 - NAT</li>
</ul></li>
<li>操作系统 root 用户的密码</li>
</ul>

<h2 id="准备虚拟机练习环境">准备虚拟机练习环境</h2>

<p>在练习的过程中主要使用笔记本电脑的网络端口准备，下面的描述以MacOS为例，Windows操作系统请理解后做相应配置。</p>

<h3 id="确定虚拟机的ip地址">确定虚拟机的IP地址</h3>

<p>如果你安装CentOS 7操作系统时，使用了静态ip地址，请依然用下面的步骤再次确认ip地址正确且可以链接。</p>

<p>登录虚拟机的控制台后，使用的命令 <code>ip add s</code> 确认虚拟机的Ip地址。如下图所示：</p>

<p><img src="/media/9601568016714_.pic_hd.jpg" alt="" /></p>

<div class="panel panel-success"><div class="panel-header">
<h3>成功</h3>
</div><div class="panel-body">
<p>记录虚拟机的Ip地址备用。</p>

</div>
</div>


<h3 id="设置virtualbox网络端口转发">设置VirtualBox网络端口转发</h3>

<p>确保笔记本电脑和虚拟机的网络端口可连接。增加3条端口转发规则。如下图所示：</p>

<p><img src="/media/9591568016572_.pic_hd.jpg" alt="9591568016572_.pic_hd" /></p>

<p>测试从笔记本电脑的操作系统ssh登录到虚拟操作系统。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"> ~ ssh root@127.0.0.1 -p <span class="m">2233</span>
Last login: Mon Sep  <span class="m">9</span> <span class="m">19</span>:29:26 <span class="m">2019</span> from <span class="m">10</span>.0.2.2
<span class="o">[</span>root@bogon ~<span class="o">]</span>#</code></pre></div>
<p>设置虚拟机主机名 <code>hostnamectl set-hostname node-1 --static</code>， 在/etc/hosts 文件配置本机 主机名 dns 解析。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@bogon config<span class="o">]</span><span class="c1"># hostnamectl set-hostname node-1 --static</span>
<span class="o">[</span>root@bogon config<span class="o">]</span><span class="c1"># vi /etc/hosts</span>
<span class="m">127</span>.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
<span class="m">10</span>.0.2.15   node-1</code></pre></div>
<div class="panel panel-success"><div class="panel-header">
<h3>成功</h3>
</div><div class="panel-body">
<p>确保 root 用户能正常ssh登录虚拟机操作系统。</p>

</div>
</div>


<h2 id="导入elasticsearch和kibana安装包文件">导入elasticsearch和kibana安装包文件</h2>

<p>使用scp命令或者同等软件将rpm安装包上传到练习虚拟机中。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">scp -P <span class="m">2233</span>  elasticsearch-7.3.2-x86_64.rpm root@127.0.0.1:/root/
scp -P <span class="m">2233</span>  kibana-7.3.2-x86_64.rpm root@127.0.0.1:/root/</code></pre></div>
<h2 id="安装-elasticsearch">安装 Elasticsearch</h2>

<p>登录虚拟机操作系统执行安装 <code>rpm -ivh elasticsearch-7.3.2-x86_64.rpm</code> 命令，并启动服务和关闭防火墙服务。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">~ ssh root@127.0.0.1 -p <span class="m">2233</span>
Last login: Thu Sep <span class="m">19</span> <span class="m">18</span>:57:31 <span class="m">2019</span> from <span class="m">10</span>.0.2.2
<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># ls</span>
anaconda-ks.cfg  elasticsearch-7.3.2-x86_64.rpm
<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># rpm -ivh elasticsearch-7.3.2-x86_64.rpm</span> 
warning: elasticsearch-7.3.2-x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID d88e42b4: NOKEY
Preparing...                          <span class="c1">################################# [100%]</span>
Creating elasticsearch group... OK
Creating elasticsearch user... OK
Updating / installing...
   <span class="m">1</span>:elasticsearch-0:7.3.2-1          <span class="c1">################################# [100%]</span>
<span class="c1">### NOT starting on installation, please execute the following statements to configure elasticsearch service to start automatically using systemd</span>
 sudo systemctl daemon-reload
 sudo systemctl <span class="nb">enable</span> elasticsearch.service
<span class="c1">### You can start elasticsearch service by executing</span>
 sudo systemctl start elasticsearch.service
Created elasticsearch keystore in /etc/elasticsearch
<span class="o">[</span>root@node-1 ~<span class="o">]</span>#

<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># systemctl stop firewalld</span>
<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># systemctl disable firewalld</span></code></pre></div>
<p>配置 Elasticsearch 服务器参数， <code>vi /etc/elasticsearch/elasticsearch.yml</code> 确保配置文件中有如下四行配置。</p>
<div class="highlight"><pre class="chroma"><code class="language-yml" data-lang="yml">cluster.name<span class="p">:</span><span class="w"> </span>my-elk<span class="w">
</span><span class="w"></span>node.name<span class="p">:</span><span class="w"> </span>node-<span class="m">1</span><span class="w">
</span><span class="w"></span>network.host<span class="p">:</span><span class="w"> </span><span class="m">0.0</span>.<span class="m">0.0</span><span class="w">
</span><span class="w"></span>cluster.initial_master_nodes<span class="p">:</span><span class="w"> </span>node-<span class="m">1</span></code></pre></div>
<p>用命令  <code>systemctl start elasticsearch</code> 启动 Elasticsearch 服务器</p>

<p>在虚拟机的命令行验证服务 <code>curl http://127.0.0.1:9200</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># systemctl enable elasticsearch</span>
Created symlink from /etc/systemd/system/multi-user.target.wants/elasticsearch.service to /usr/lib/systemd/system/elasticsearch.service.
<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># systemctl start elasticsearch</span>
<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># systemctl status elasticsearch</span>
● elasticsearch.service - Elasticsearch
   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/elasticsearch.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: disabled<span class="o">)</span>
   Active: active <span class="o">(</span>running<span class="o">)</span> since Thu <span class="m">2019</span>-09-19 <span class="m">19</span>:55:48 CST<span class="p">;</span> 1h 34min ago
     Docs: http://www.elastic.co
 Main PID: <span class="m">12869</span> <span class="o">(</span>java<span class="o">)</span>
   CGroup: /system.slice/elasticsearch.service
           ├─12869 /usr/share/elasticsearch/jdk/bin/java -Xms1g -Xmx1g -XX:+UseConcMarkSweepGC -XX:C...
           └─12948 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Sep <span class="m">19</span> <span class="m">19</span>:55:48 node-1 systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Stopped Elasticsearch.
Sep <span class="m">19</span> <span class="m">19</span>:55:48 node-1 systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Started Elasticsearch.
Sep <span class="m">19</span> <span class="m">19</span>:55:49 node-1 elasticsearch<span class="o">[</span><span class="m">12869</span><span class="o">]</span>: OpenJDK <span class="m">64</span>-Bit Server VM warning: Option UseConcMark...se.
Hint: Some lines were ellipsized, use -l to show in full.

<span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># curl 127.0.0.1:9200</span>
<span class="o">{</span>
  <span class="s2">&#34;name&#34;</span> : <span class="s2">&#34;node-1&#34;</span>,
  <span class="s2">&#34;cluster_name&#34;</span> : <span class="s2">&#34;my-elk&#34;</span>,
  <span class="s2">&#34;cluster_uuid&#34;</span> : <span class="s2">&#34;IMvIAEvNTBmlYINm_iI5bA&#34;</span>,
  <span class="s2">&#34;version&#34;</span> : <span class="o">{</span>
    <span class="s2">&#34;number&#34;</span> : <span class="s2">&#34;7.3.2&#34;</span>,
    <span class="s2">&#34;build_flavor&#34;</span> : <span class="s2">&#34;default&#34;</span>,
    <span class="s2">&#34;build_type&#34;</span> : <span class="s2">&#34;rpm&#34;</span>,
    <span class="s2">&#34;build_hash&#34;</span> : <span class="s2">&#34;1c1faf1&#34;</span>,
    <span class="s2">&#34;build_date&#34;</span> : <span class="s2">&#34;2019-09-06T14:40:30.409026Z&#34;</span>,
    <span class="s2">&#34;build_snapshot&#34;</span> : false,
    <span class="s2">&#34;lucene_version&#34;</span> : <span class="s2">&#34;8.1.0&#34;</span>,
    <span class="s2">&#34;minimum_wire_compatibility_version&#34;</span> : <span class="s2">&#34;6.8.0&#34;</span>,
    <span class="s2">&#34;minimum_index_compatibility_version&#34;</span> : <span class="s2">&#34;6.0.0-beta1&#34;</span>
  <span class="o">}</span>,
  <span class="s2">&#34;tagline&#34;</span> : <span class="s2">&#34;You Know, for Search&#34;</span>
<span class="o">}</span></code></pre></div>
<p>在笔记本电脑的浏览器里输入网址 <code>http://127.0.0.1:9200</code> 验证 Elasticsearch 服务是否可以访问。</p>

<p><img src="/media/15689001330273.jpg" alt="" /></p>

<div class="panel panel-success"><div class="panel-header">
<h3>成功</h3>
</div><div class="panel-body">
<ol>
<li>在虚拟机操作系统的命令行里 curl 127.0.0.1:9200 正常返回</li>
<li>在笔记本电脑的浏览器里 <a href="http://127.0.0.1:9200">http://127.0.0.1:9200</a> 能看到与上面相同的信息</li>
</ol>

</div>
</div>


<h2 id="安装-kibana">安装 Kibana</h2>

<p>执行Kibana 服务器安装命令 <code>rpm -ivh kibana-7.3.2-x86_64.rpm</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@node-1 ~<span class="o">]</span><span class="c1"># rpm -ivh kibana-7.3.2-x86_64.rpm</span>
warning: kibana-7.3.2-x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID d88e42b4: NOKEY
Preparing...                          <span class="c1">################################# [100%]</span>
Updating / installing...
   <span class="m">1</span>:kibana-7.3.2-1                   <span class="c1">################################# [100%]</span>
<span class="o">[</span>root@node-1 ~<span class="o">]</span>#</code></pre></div>
<p>确保 Kibana 配置文件  <code>vi /etc/kibana/kibana.yml</code>  中有下面几行参数：</p>
<div class="highlight"><pre class="chroma"><code class="language-yml" data-lang="yml">server.host<span class="p">:</span><span class="w"> </span><span class="s2">&#34;10.0.2.15&#34;</span><span class="w">
</span><span class="w"></span>server.name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;node-1&#34;</span><span class="w">
</span><span class="w"></span>elasticsearch.hosts<span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;http://localhost:9200&#34;</span><span class="p">]</span><span class="w">
</span><span class="w"></span>i18n.locale<span class="p">:</span><span class="w"> </span><span class="s2">&#34;zh-CN&#34;</span></code></pre></div>
<p>在本机的浏览器访问 Kibana 服务器。选择使用 <code>我们的样例数据</code>。
<img src="/media/9571568015382_.pic_hd.jpg" alt="9571568015382_.pic_hd" /></p>

<p>添加三组样例数据。</p>

<p><img src="/media/9581568015418_.pic_hd.jpg" alt="9581568015418_.pic_hd" /></p>

<p>点击左侧导航栏的仪表板按钮，看到如下仪表板清单。</p>

<p><img src="/media/15689013007062.jpg" alt="" /></p>

<div class="panel panel-success"><div class="panel-header">
<h3>成功</h3>
</div><div class="panel-body">
<p>笔记本电脑的浏览器可以正常访问 Kibana 服务器。</p>

</div>
</div>


<div class="panel panel-danger"><div class="panel-header">
<h3>危险</h3>
</div><div class="panel-body">
<ul>
<li>Elasticsearch 服务器没有开启默认的用户名和密码的安全认证模式，在生产环境中是完全不可取的。</li>
<li>以上的网络配置和各种服务器配置也是精简版本的，仅限于课堂学习，生产环境的服务器配置需要按照实际情况设计。</li>
</ul>

</div>
</div>

<div class="edit-meta">
Last updated on 2017-10-17


<br>
Published on 2017-10-17
<br><a href="https://github.com/martinliu/elasticstack-workshop/edit/master/content/getting-started/installation.md" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class="pagination"><a class="nav nav-prev" href="/getting-started/" title="准备实验环境"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 准备实验环境</a>
<a class="nav nav-next" href="/getting-started/1/" title="获得Elastic云环境">Next - 获得Elastic云环境 <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">
<nav>
<ul>
<li class=""><a href="https://elk-workshop.github.io/">Home</a></li>

<li class="parent"><a href="/getting-started/">准备实验环境</a>
<ul class="sub-menu">
<li class="active"><a href="/getting-started/installation/">本地安装</a></li>
<li class=""><a href="/getting-started/1/">获得Elastic云环境</a></li>
<li class=""><a href="/getting-started/configuration/">环境确认</a></li>
</ul>
  
</li>

<li class=""><a href="/sample/">获取测试数据</a>
</li>

<li class=""><a href="/chapter1/">L1 Elasticsearch基础</a>
<ul class="">
<li class=""><a href="/chapter1/1/">节点管理</a></li>
<li class=""><a href="/chapter1/2/">数据管理</a></li>
<li class=""><a href="/chapter1/3/">数据集管理</a></li>
<li class=""><a href="/chapter1/4/">集群高级管理</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter2/">L2 Logstash实战</a>
<ul class="">
<li class=""><a href="/chapter2/1/">运行Logstash</a></li>
<li class=""><a href="/chapter2/2/">测试首条流水线</a></li>
<li class=""><a href="/chapter2/3/">插件管理</a></li>
<li class=""><a href="/chapter2/4/">使用File input插件</a></li>
<li class=""><a href="/chapter2/5/">使用JDBC input插件</a></li>
<li class=""><a href="/chapter2/6/">使用ES output插件</a></li>
<li class=""><a href="/chapter2/7/">使用csv output插件</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter3/">L3 Elasticsearch大数据实战</a>
<ul class="">
<li class=""><a href="/chapter3/1/">Bucket 聚合</a></li>
<li class=""><a href="/chapter3/2/">Metric 聚合</a></li>
<li class=""><a href="/chapter3/3/">Matrix 聚合</a></li>

<li class=""><a href="/chapter3/chapter3-2/">实战案例1-Wifi服务</a>
<ul class="">
<li class=""><a href="/chapter3/chapter3-2/3/">Wifi使用率概况</a></li>
<li class=""><a href="/chapter3/chapter3-2/7/">位置分析</a></li>
<li class=""><a href="/chapter3/chapter3-2/5/">使用率分析</a></li>
<li class=""><a href="/chapter3/chapter3-2/1/">导入测试数据</a></li>
<li class=""><a href="/chapter3/chapter3-2/4/">排名分析</a></li>
<li class=""><a href="/chapter3/chapter3-2/6/">用户模式分析</a></li>
<li class=""><a href="/chapter3/chapter3-2/2/">确认导入结果</a></li>
</ul>
  
</li>
</ul>
  
</li>

<li class=""><a href="/chapter4/">L4 Logstash数据清洗实战</a>
<ul class="">
<li class=""><a href="/chapter4/1/">CSV Filter解析csv文件</a></li>
<li class=""><a href="/chapter4/2/">Mutate Filter处理字段</a></li>
<li class=""><a href="/chapter4/3/">Grok Filter解析</a></li>
<li class=""><a href="/chapter4/4/">Geoip Filter解释</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter5/">L5 Beats数据摄入实战</a>
<ul class="">
<li class=""><a href="/chapter5/1/">使用Filebeat采集日志</a></li>
<li class=""><a href="/chapter5/2/">使用Metricbeat采集指标</a></li>
<li class=""><a href="/chapter5/3/">使用Heartbeat</a></li>
<li class=""><a href="/chapter5/4/">使用Packetbeat采集</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter6/">L6 Kibana数据可视化和分析实战</a>
<ul class="">
<li class=""><a href="/chapter6/1/">导入Apache日志</a></li>
<li class=""><a href="/chapter6/2/">配置Index Pattern</a></li>
<li class=""><a href="/chapter6/3/">浏览和搜索日志</a></li>
<li class=""><a href="/chapter6/4/">使用Discover查询</a></li>
<li class=""><a href="/chapter6/5/">复杂查询</a></li>
<li class=""><a href="/chapter6/6/">DSL执行查询</a></li>
<li class=""><a href="/chapter6/7/">Kibana查询管理</a></li>
<li class=""><a href="/chapter6/8/">过滤器使用</a></li>
<li class=""><a href="/chapter6/9/">数据可视化</a></li>
<li class=""><a href="/chapter6/10/">网站分析实战</a></li>
<li class=""><a href="/chapter6/11/">管理仪表板</a></li>
<li class=""><a href="/chapter6/12/">Timeline时间序列分析</a></li>
<li class=""><a href="/chapter6/13/">Kibana插件管理</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter7/">L7 IoT应用案例实战</a>
<ul class="">
<li class=""><a href="/chapter7/1/">准备数据结构</a></li>
<li class=""><a href="/chapter7/2/">数据库初始化</a></li>
<li class=""><a href="/chapter7/3/">数据处理流水线</a></li>
<li class=""><a href="/chapter7/4/">构建业务前端</a></li>
</ul>
  
</li>
</ul>
</nav>


<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
