<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>在 Windows 10 上运行 Elasticsearch 8.1.0 - Elastic Stack Workshop | 刘征 Developer Advocate @ Elastic</title><meta name=description content="搜索、观测、保护三大解决方案实战教程，各种级别和类型的学习资料，欢迎一起学习和共建。"><meta name=generator content="Hugo 0.105.0"><link href=https://elastic.martinliu.cn//index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://elastic.martinliu.cn/chapter3/chapter3-1/2/><link rel=stylesheet href=https://elastic.martinliu.cn/css/theme.min.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://elastic.martinliu.cn/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>
<script src=https://elastic.martinliu.cn/js/bundle.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-77731594-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-77731594-1")</script><style>:root{--custom-background-color:rgb(0,191,179)}</style><meta property="og:title" content="在 Windows 10 上运行 Elasticsearch 8.1.0"><meta property="og:description" content="在 Window 10 上运行 Elasticsearch 的目标往往是开发。 Elasticsearch 软件包的下载路径： https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.1.0-windows-x86_64.zip Kibana 软件包下载路径： https://artifacts.elastic.co/downloads/kibana/kibana-8.1.0-windows-x86_64.zip 学习目标： 在本地模拟运行三节点 Elasticsearch 集群 修改 Elasticsearch 内置管理员用户 elastic 的密码 运"><meta property="og:type" content="article"><meta property="og:url" content="https://elastic.martinliu.cn/chapter3/chapter3-1/2/"><meta property="og:image" content="https://elastic.martinliu.cn/images/elastic-stack-logo.png"><meta property="article:section" content="chapter3"><meta property="article:published_time" content="2017-10-17T15:26:15+00:00"><meta property="article:modified_time" content="2017-10-17T15:26:15+00:00"><meta property="og:site_name" content="Elastic Stack Workshop"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://elastic.martinliu.cn/images/elastic-stack-logo.png"><meta name=twitter:title content="在 Windows 10 上运行 Elasticsearch 8.1.0"><meta name=twitter:description content="在 Window 10 上运行 Elasticsearch 的目标往往是开发。 Elasticsearch 软件包的下载路径： https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.1.0-windows-x86_64.zip Kibana 软件包下载路径： https://artifacts.elastic.co/downloads/kibana/kibana-8.1.0-windows-x86_64.zip 学习目标： 在本地模拟运行三节点 Elasticsearch 集群 修改 Elasticsearch 内置管理员用户 elastic 的密码 运"><meta itemprop=name content="在 Windows 10 上运行 Elasticsearch 8.1.0"><meta itemprop=description content="在 Window 10 上运行 Elasticsearch 的目标往往是开发。 Elasticsearch 软件包的下载路径： https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.1.0-windows-x86_64.zip Kibana 软件包下载路径： https://artifacts.elastic.co/downloads/kibana/kibana-8.1.0-windows-x86_64.zip 学习目标： 在本地模拟运行三节点 Elasticsearch 集群 修改 Elasticsearch 内置管理员用户 elastic 的密码 运"><meta itemprop=datePublished content="2017-10-17T15:26:15+00:00"><meta itemprop=dateModified content="2017-10-17T15:26:15+00:00"><meta itemprop=wordCount content="1682"><meta itemprop=image content="https://elastic.martinliu.cn/images/elastic-stack-logo.png"><meta itemprop=keywords content><script src=/js/elastic-apm-rum.umd.min.js></script>
<script>elasticApm.init({serviceName:"Elastic-Stack-Workshop",environment:"production",serviceVersion:"1.2.3",breakdownMetrics:"true",serverUrl:"https://b1c7fb0e25894d4db3cabb678546c24f.apm.ap-east-1.aws.elastic-cloud.com:443"})</script></head><body><div class=container><header><h1>Elastic Stack Workshop | 刘征 Developer Advocate @ Elastic</h1><span class=version>Version 0.2.5</span><a href=https://github.com/martinliu/elasticstack-workshop class=github><i class="fab fa-github"></i></a><p class=description>搜索、观测、保护三大解决方案实战教程，各种级别和类型的学习资料，欢迎一起学习和共建。</p></header><div class=global-menu><nav><ul><li><a href=/>首页</a></li><li><a href=https://martinliu.cn>博客</a></li><li><a href=/workshop/>教程</a></li><li><a href=/contribution/>贡献</a></li></ul></nav></div><div class=content-container><main><h1>在 Windows 10 上运行 Elasticsearch 8.1.0</h1><p>在 Window 10 上运行 Elasticsearch 的目标往往是开发。</p><p>Elasticsearch 软件包的下载路径： <a href=https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.1.0-windows-x86_64.zip>https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.1.0-windows-x86_64.zip</a>
Kibana 软件包下载路径： <a href=https://artifacts.elastic.co/downloads/kibana/kibana-8.1.0-windows-x86_64.zip>https://artifacts.elastic.co/downloads/kibana/kibana-8.1.0-windows-x86_64.zip</a></p><p>学习目标：</p><ol><li>在本地模拟运行三节点 Elasticsearch 集群</li><li>修改 Elasticsearch 内置管理员用户 elastic 的密码</li><li>运行 Kibana 服务，启用内置的 Elastic Stack 监控功能</li></ol><p>将下载的软件包放在名为 <code>lab2</code> 的目录中，并在这个目录中创建三个空目录：node1 、 node2 和 node3。</p><p>使用 Windows 的解压缩工具将 Elasticsearch 软件包解压缩三次，放在node1 、 node2 和 node3不同的目录中备用。将Kibana加压缩后放在 <code>lab2</code> 目录下。</p><p><img src=/images/ch3/Snag_527b42f5.png alt></p><p>打开一个新的Windows Terminal命令行窗口，进入 node1 的 elasticsearch-8.1.0 目录中，运行下面这条命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>.<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\e</span>lasticsearch.bat -E cluster.name<span style=color:#f92672>=</span>3m -E node.name<span style=color:#f92672>=</span>node1
</span></span></code></pre></div><p>参数解释：</p><ul><li>cluster.name=3m 设定集群的名称为 3m</li><li>node.name=node1 设定本节点的名称为 node1</li></ul><p>在以上滚动输出的日志信息中，复制粘贴类似于下面的部分到一个文本编辑器中。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>-&gt; Elasticsearch security features have been automatically configured!
</span></span><span style=display:flex><span>-&gt; Authentication is enabled and cluster connections are encrypted.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-&gt;  Password <span style=color:#66d9ef>for</span> the elastic user <span style=color:#f92672>(</span>reset with <span style=color:#e6db74>`</span>bin/elasticsearch-reset-password -u elastic<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>=</span>dU6*44bgrlnvAqptgqt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-&gt;  HTTP CA certificate SHA-256 fingerprint:
</span></span><span style=display:flex><span>  62d0fbc0a86c0eeb6cbb7a0ffde500ea245fce6f08dfda76558c3ffe6a826cfd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-&gt;  Configure Kibana to use this cluster:
</span></span><span style=display:flex><span>* Run Kibana and click the configuration link in the terminal when Kibana starts.
</span></span><span style=display:flex><span>* Copy the following enrollment token and paste it into Kibana in your browser <span style=color:#f92672>(</span>valid <span style=color:#66d9ef>for</span> the next <span style=color:#ae81ff>30</span> minutes<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>  eyJ2ZXIiOiI4LjEuMCIsImFkciI6WyIxNzIuMjguMTQ0LjE6OTIwMCIsIjE5Mi4xNjguMzEuMjQwOjkyMDAiXSwiZmdyIjoiNjJkMGZiYzBhODZjMGVlYjZjYmI3YTBmZmRlNTAwZWEyNDVmY2U2ZjA4ZGZkYTc2NTU4YzNmZmU2YTgyNmNmZCIsImtleSI6IlAwTVBvSDhCOVA4RmoyVl9IQUUtOjBVS0lkOWlOUmRDbU9DRi1lMWtwV0EifQ<span style=color:#f92672>==</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-&gt;  Configure other nodes to join this cluster:
</span></span><span style=display:flex><span>* On this node:
</span></span><span style=display:flex><span>  - Create an enrollment token with <span style=color:#e6db74>`</span>bin/elasticsearch-create-enrollment-token -s node<span style=color:#e6db74>`</span>.
</span></span><span style=display:flex><span>  - Uncomment the transport.host setting at the end of config/elasticsearch.yml.
</span></span><span style=display:flex><span>  - Restart Elasticsearch.
</span></span><span style=display:flex><span>* On other nodes:
</span></span><span style=display:flex><span>  - Start Elasticsearch with <span style=color:#e6db74>`</span>bin/elasticsearch --enrollment-token &lt;token&gt;<span style=color:#e6db74>`</span>, using the enrollment token that you generated.
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span></code></pre></div><p>在弹出的窗口上点击“运行访问”按钮。</p><p><img src=/images/ch3/Snag_529f7ea7.png alt></p><p>这样就成功的启动了 3m 集群里的首个节点，以上启动过程，完成了几件重要的系统安全保障工作。</p><ul><li>为 elastic 用户创建了随机密码</li><li>为 Elasticsearch 集群创建了一套节点间加密传授的数字证书</li><li>为 Kibana 服务器创建了注册配置令牌</li><li>给出了其它 Elasticsearch 节点加入这个 3m 集群的操作方法</li></ul><p>由于随机生成的用户密码不方便使用，使用下面的命令修改 elastic 用户的密码。打开一个新的 Windows Terminal 命令行窗口，进入 node1 的 elasticsearch-8.1.0/bin 目录里。
执行命令 <code>.\elasticsearch-reset-password -u elastic -i</code> 。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode1<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\b</span>in&gt; .<span style=color:#ae81ff>\e</span>lasticsearch-reset-password -u elastic -i
</span></span><span style=display:flex><span>This tool will reset the password of the <span style=color:#f92672>[</span>elastic<span style=color:#f92672>]</span> user.
</span></span><span style=display:flex><span>You will be prompted to enter the password.
</span></span><span style=display:flex><span>Please confirm that you would like to <span style=color:#66d9ef>continue</span> <span style=color:#f92672>[</span>y/N<span style=color:#f92672>]</span>y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter password <span style=color:#66d9ef>for</span> <span style=color:#f92672>[</span>elastic<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span>Re-enter password <span style=color:#66d9ef>for</span> <span style=color:#f92672>[</span>elastic<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span>Password <span style=color:#66d9ef>for</span> the <span style=color:#f92672>[</span>elastic<span style=color:#f92672>]</span> user successfully reset.
</span></span><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode1<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\b</span>in&gt;
</span></span></code></pre></div><p>上面就成功的修改了 elastic 用户的密码，记录该密码备用。在这个命令行窗口中运行 <code>.\elasticsearch-create-enrollment-token -s node</code> 命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode1<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\b</span>in&gt; .<span style=color:#ae81ff>\e</span>lasticsearch-create-enrollment-token -s node
</span></span><span style=display:flex><span>eyJ2ZXIiOiI4LjEuMCIsImFkciI6WyIxOTIuMTY4LjMxLjI0MDo5MjAwIiwiMTcyLjI4LjE0NC4xOjkyMDAiXSwiZmdyIjoiNjJkMGZiYzBhODZjMGVlYjZjYmI3YTBmZmRlNTAwZWEyNDVmY2U2ZjA4ZGZkYTc2NTU4YzNmZmU2YTgyNmNmZCIsImtleSI6IlFFTVhvSDhCOVA4RmoyVl9hZ0czOml3ck9wMEJxUzBteXJxVEJLM1pVUUEifQ<span style=color:#f92672>==</span>
</span></span><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode1<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\b</span>in&gt;
</span></span></code></pre></div><p>在上面的命令行输出信息中，复制所产生的集群加群令牌，备用。</p><p>修改首个节点 node1 的配置文件，在 node1 目录中，用编辑器打开配置文件 <code>config/elasticsearch.yml</code> ，搜索到 <code>transport.host</code> 这个参数所在的行，将本行的注释取消。回到 node1 的 Elasticsearch 服务启动的命令行窗口中，按 <code>ctrl + c</code> 停止 Elasticsearch 服务，然后再次启动该节点。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e># Allow other nodes to join the cluster from localhost and local networks</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Connections are encrypted and mutually authenticated</span>
</span></span><span style=display:flex><span><span style=color:#f92672>transport.host</span>: [<span style=color:#ae81ff>_local_, _site_]</span>
</span></span></code></pre></div><p>打开新的Windows Terminal命令行窗口，进入 lab2 目录，解压缩 Kibana 软件包，进入 Kibana 目录，然后启动 Kibana 服务器。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2&gt; cd .<span style=color:#ae81ff>\k</span>ibana-8.1.0<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\k</span>ibana-8.1.0&gt; ls
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    目录: C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\k</span>ibana-8.1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode                 LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                 -------------         ------ ----
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                bin
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                config
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                data
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                logs
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                node
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                node_modules
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                plugins
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                src
</span></span><span style=display:flex><span>d-----          2022/3/3     14:49                x-pack
</span></span><span style=display:flex><span>------          2022/3/3     14:49           <span style=color:#ae81ff>4144</span> .i18nrc.json
</span></span><span style=display:flex><span>------          2022/3/3     14:49           <span style=color:#ae81ff>3860</span> LICENSE.txt
</span></span><span style=display:flex><span>------          2022/3/3     14:49        <span style=color:#ae81ff>1417101</span> NOTICE.txt
</span></span><span style=display:flex><span>------          2022/3/3     14:49            <span style=color:#ae81ff>738</span> package.json
</span></span><span style=display:flex><span>------          2022/3/3     14:49           <span style=color:#ae81ff>3966</span> README.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\k</span>ibana-8.1.0&gt; .<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\k</span>ibana.bat
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:03:06.541+08:00<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>plugins-service<span style=color:#f92672>]</span> Plugin <span style=color:#e6db74>&#34;metricsEntities&#34;</span> is disabled.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:03:06.632+08:00<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>http.server.Preboot<span style=color:#f92672>]</span> http server running at http://localhost:5601
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:03:06.697+08:00<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>plugins-system.preboot<span style=color:#f92672>]</span> Setting up <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> plugins: <span style=color:#f92672>[</span>interactiveSetup<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:03:06.700+08:00<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>preboot<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;interactiveSetup&#34;</span> plugin is holding setup: Validating Elasticsearch connection configuration…
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:03:06.734+08:00<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>root<span style=color:#f92672>]</span> Holding setup <span style=color:#66d9ef>until</span> preboot stage is completed.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>i Kibana has not been configured.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Go to http://localhost:5601/?code<span style=color:#f92672>=</span><span style=color:#ae81ff>813984</span> to get started.
</span></span></code></pre></div><p>在 Kibana 服务器正常启动之后，打开一个浏览器，输入 Kibana 的访问地址：<code>http://localhost:5601/?code=813984</code>；在 Kibana 的首次登陆配置界面中粘贴入 node1 节点首次启动时所生成的 Kibana 注册令牌，然后点击 ”Configure Elastic“ 按钮。等待 Kibana 配置完毕之后，使用 elastic 用户登录 Kibna。</p><p>在 Kibana 左侧菜单中，点击 Management -> Stack Montitoring ，选择启用集群自监控功能。【点击选择 &ndash;》 Or, set up with self monitoring】；然后进入 3m 集群的节点监控界面。如下图所示。</p><p><img src=/images/ch3/2022-03-19_01-00-24.png alt></p><p>【下面的练习是可选操作，以上已经完成了 Elasticsearch 和 Kibna的基础搭建。】 Elasticsearch 是一个分布式搜索系统，执行后续的操作是在一个操作系统内，模拟3节点对等集群的操作。</p><p>下面开始模拟 node2 和 node3 加入 3m 集群。</p><p>打开新的Windows Terminal命令行窗口，进入 node2 的 elasticsearch-8.1.0 目录中。执行下面的命令，注意这里所使用的 token 是上面的命令所生成的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span> .<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\e</span>lasticsearch.bat  -E cluster.name<span style=color:#f92672>=</span>3m -E node.name<span style=color:#f92672>=</span>node2   --enrollment-token  eyJ2ZXIiOiI4LjEuMCIsImFkciI6WyIxOTIuMTY4LjMxLjI0MDo5MjAwIiwiMTcyLjI4LjE0NC4xOjkyMDAiXSwiZmdyIjoiNjJkMGZiYzBhODZjMGVlYjZjYmI3YTBmZmRlNTAwZWEyNDVmY2U2ZjA4ZGZkYTc2NTU4YzNmZmU2YTgyNmNmZCIsImtleSI6IlFFTVhvSDhCOVA4RmoyVl9hZ0czOml3ck9wMEJxUzBteXJxVEJLM1pVUUEifQ<span style=color:#f92672>==</span>
</span></span></code></pre></div><p>命令执行的过程如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>PS C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode2<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0&gt; .<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\e</span>lasticsearch.bat  -E cluster.name<span style=color:#f92672>=</span>3m -E node.name<span style=color:#f92672>=</span>node2   --enrollment-token  eyJ2ZXIiOiI4LjEuMCIsImFkciI6WyIxOTIuMTY4LjMxLjI0MDo5MjAwIiwiMTcyLjI4LjE0NC4xOjkyMDAiXSwiZmdyIjoiNjJkMGZiYzBhODZjMGVlYjZjYmI3YTBmZmRlNTAwZWEyNDVmY2U2ZjA4ZGZkYTc2NTU4YzNmZmU2YTgyNmNmZCIsImtleSI6IlFFTVhvSDhCOVA4RmoyVl9hZ0czOml3ck9wMEJxUzBteXJxVEJLM1pVUUEifQ<span style=color:#f92672>==</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:23,617<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.n.Node               <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> version<span style=color:#f92672>[</span>8.1.0<span style=color:#f92672>]</span>, pid<span style=color:#f92672>[</span>20036<span style=color:#f92672>]</span>, build<span style=color:#f92672>[</span>default/zip/3700f7679f7d95e36da0b43762189bab189bc53a/2022-03-03T14:20:00.690422633Z<span style=color:#f92672>]</span>, OS<span style=color:#f92672>[</span>Windows 11/10.0/amd64<span style=color:#f92672>]</span>, JVM<span style=color:#f92672>[</span>Eclipse Adoptium/OpenJDK 64-Bit Server VM/17.0.2/17.0.2+8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:23,624<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.n.Node               <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> JVM home <span style=color:#f92672>[</span>C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode2<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\j</span>dk<span style=color:#f92672>]</span>, using bundled JDK <span style=color:#f92672>[</span>true<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:23,625<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.n.Node               <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> JVM arguments <span style=color:#f92672>[</span>-Des.networkaddress.cache.ttl<span style=color:#f92672>=</span>60, -Des.networkaddress.cache.negative.ttl<span style=color:#f92672>=</span>10, -Djava.security.manager<span style=color:#f92672>=</span>allow, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless<span style=color:#f92672>=</span>true, -Dfile.encoding<span style=color:#f92672>=</span>UTF-8, -Djna.nosys<span style=color:#f92672>=</span>true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe<span style=color:#f92672>=</span>true, -Dio.netty.noKeySetOptimization<span style=color:#f92672>=</span>true, -Dio.netty.recycler.maxCapacityPerThread<span style=color:#f92672>=</span>0, -Dio.netty.allocator.numDirectArenas<span style=color:#f92672>=</span>0, -Dlog4j.shutdownHookEnabled<span style=color:#f92672>=</span>false, -Dlog4j2.disable.jmx<span style=color:#f92672>=</span>true, -Dlog4j2.formatMsgNoLookups<span style=color:#f92672>=</span>true, -Djava.locale.providers<span style=color:#f92672>=</span>SPI,COMPAT, --add-opens<span style=color:#f92672>=</span>java.base/java.io<span style=color:#f92672>=</span>ALL-UNNAMED, -XX:+UseG1GC, -Djava.io.tmpdir<span style=color:#f92672>=</span>C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\l</span>iuma<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp<span style=color:#ae81ff>\e</span>lasticsearch, -XX:+HeapDumpOnOutOfMemoryError, -XX:+ExitOnOutOfMemoryError, -XX:HeapDumpPath<span style=color:#f92672>=</span>data, -XX:ErrorFile<span style=color:#f92672>=</span>logs/hs_err_pid%p.log, -Xlog:gc*,gc+age<span style=color:#f92672>=</span>trace,safepoint:file<span style=color:#f92672>=</span>logs/gc.log:utctime,pid,tags:filecount<span style=color:#f92672>=</span>32,filesize<span style=color:#f92672>=</span>64m, -Xms16329m, -Xmx16329m, -XX:MaxDirectMemorySize<span style=color:#f92672>=</span>8564768768, -XX:InitiatingHeapOccupancyPercent<span style=color:#f92672>=</span>30, -XX:G1ReservePercent<span style=color:#f92672>=</span>25, -Delasticsearch, -Des.path.home<span style=color:#f92672>=</span>C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode2<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0, -Des.path.conf<span style=color:#f92672>=</span>C:<span style=color:#ae81ff>\e</span>lk<span style=color:#ae81ff>\l</span>ab2<span style=color:#ae81ff>\n</span>ode2<span style=color:#ae81ff>\e</span>lasticsearch-8.1.0<span style=color:#ae81ff>\c</span>onfig, -Des.distribution.flavor<span style=color:#f92672>=</span>default, -Des.distribution.type<span style=color:#f92672>=</span>zip, -Des.bundled_jdk<span style=color:#f92672>=</span>true<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,838<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>aggs-matrix-stats<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,838<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>analysis-common<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,839<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>constant-keyword<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,839<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>data-streams<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,839<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>frozen-indices<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2022-03-19T11:13:28,840<span style=color:#f92672>][</span>INFO <span style=color:#f92672>][</span>o.e.p.PluginsService     <span style=color:#f92672>]</span> <span style=color:#f92672>[</span>node2<span style=color:#f92672>]</span> loaded module <span style=color:#f92672>[</span>ingest-common<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>打开新的Windows Terminal命令行窗口，进入 node3 的 elasticsearch-8.1.0 目录中。执行下面的命令，注意这里所使用的 token 是上面的命令所生成的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span> .<span style=color:#ae81ff>\b</span>in<span style=color:#ae81ff>\e</span>lasticsearch.bat  -E cluster.name<span style=color:#f92672>=</span>3m -E node.name<span style=color:#f92672>=</span>node3   --enrollment-token  eyJ2ZXIiOiI4LjEuMCIsImFkciI6WyIxOTIuMTY4LjMxLjI0MDo5MjAwIiwiMTcyLjI4LjE0NC4xOjkyMDAiXSwiZmdyIjoiNjJkMGZiYzBhODZjMGVlYjZjYmI3YTBmZmRlNTAwZWEyNDVmY2U2ZjA4ZGZkYTc2NTU4YzNmZmU2YTgyNmNmZCIsImtleSI6IlFFTVhvSDhCOVA4RmoyVl9hZ0czOml3ck9wMEJxUzBteXJxVEJLM1pVUUEifQ<span style=color:#f92672>==</span>
</span></span></code></pre></div><p>在 Elastic Stack 集群自监控界面上，确认 3m 集群里所加入的两个新的节点。</p><div class=edit-meta>Last updated on 2017-10-17<br>Published on 2017-10-17<br><a href=https://github.com/martinliu/elasticstack-workshop/edit/master/content/chapter3/chapter3-1/2.md class=edit-page><i class="fas fa-pen-square"></i>&nbsp;Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=https://elastic.martinliu.cn/chapter3/chapter3-1/1/ title="在 macOS 上运行 Elasticsearch 8.1.0"><i class="fas fa-arrow-left" aria-hidden=true></i>&nbsp;Prev - 在 macOS 上运行 Elasticsearch 8.1.0</a>
<a class="nav nav-next" href=https://elastic.martinliu.cn/chapter3/chapter3-1/3/ title="在 Linux 上运行 Elasticsearch 8.1.0">Next - 在 Linux 上运行 Elasticsearch 8.1.0 <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://elastic.martinliu.cn/>Home</a></li><li class=has-sub-menu><a href=https://elastic.martinliu.cn/getting-started/>新手入门<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/getting-started/configuration/>Configuration</a></li><li><a href=https://elastic.martinliu.cn/getting-started/screenshot/>Screenshot</a></li><li class=has-sub-menu><a href=https://elastic.martinliu.cn/getting-started/local/>本地安装<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/getting-started/local/installation-macos/>MacOS 本地安装</a></li><li><a href=https://elastic.martinliu.cn/getting-started/local/installation-linux/>Linux 本地安装</a></li><li><a href=https://elastic.martinliu.cn/getting-started/local/installation-win/>Windows 本地安装</a></li></ul></li></ul></li><li class=has-sub-menu><a href=https://elastic.martinliu.cn/chapter1/>新手 100 系列<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/chapter1/1/>在 CentOS 上安装 Elastic Stack 7.16</a></li><li><a href=https://elastic.martinliu.cn/chapter1/2/>洞察 GitHub 开源项目的开发效能</a></li><li><a href=https://elastic.martinliu.cn/chapter1/3/>Chapter 1-3</a></li><li><a href=https://elastic.martinliu.cn/chapter1/4/>Chapter 1-4</a></li></ul></li><li class=has-sub-menu><a href=https://elastic.martinliu.cn/sample/>编写规范<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/sample/markdown-syntax/>MD基础语法</a></li><li><a href=https://elastic.martinliu.cn/sample/table-of-contents/>内容目录</a></li><li><a href=https://elastic.martinliu.cn/sample/build-in-shortcodes/>内置短代码</a></li><li><a href=https://elastic.martinliu.cn/sample/custom-shortcodes/>自定义短代码</a></li><li><a href=https://elastic.martinliu.cn/sample/search-shortcode/>搜索短代码</a></li></ul></li><li class="parent has-sub-menu"><a href=https://elastic.martinliu.cn/chapter3/>Mini 系列<span class="mark opened">-</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/chapter3/beats/3/>Beats</a></li><li class="parent has-sub-menu"><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/>Elasticsearch<span class="mark opened">-</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/1/>在 macOS 上运行 Elasticsearch 8.1.0</a></li><li class=active><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/2/>在 Windows 10 上运行 Elasticsearch 8.1.0</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/3/>在 Linux 上运行 Elasticsearch 8.1.0</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/4/>使用 rpm/deb 软件包安装 Elasticsearch 8.1.0</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-1/5/>Elastic Stack Fleet 服务器配置指南（v8.5）</a></li></ul></li><li><a href=https://elastic.martinliu.cn/chapter3/enterprise-search/5/>Enterprise Search</a></li><li class=has-sub-menu><a href=https://elastic.martinliu.cn/chapter3/chapter3-2/>Kibana<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-2/2/>Chapter 3-2-2</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-2/3/>Chapter 3-2-3</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-2/4/>Chapter 3-2-4</a></li><li><a href=https://elastic.martinliu.cn/chapter3/chapter3-2/1/>在 macOS 上运行 Kibana</a></li></ul></li><li><a href=https://elastic.martinliu.cn/chapter3/logstash/4/>Logstash</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>